package com.appserver.webservice.rest.identity;

import java.util.Map;
import java.util.TreeMap;

import javax.ws.rs.GET;
import javax.ws.rs.PUT;
import javax.ws.rs.Path;
import javax.ws.rs.PathParam;
import javax.ws.rs.Produces;
import javax.ws.rs.QueryParam;
import javax.ws.rs.WebApplicationException;
import javax.ws.rs.core.Response;

/**
 * curl -X PUT http://127.0.0.1:9090/orders-server/orders/1?customer_name=bob 
 * curl -X GET http://127.0.0.1:9090/orders-server/orders/1 
 * curl -X GET http://127.0.0.1:9090/orders-server/orders/list
 */

@Path("users")
public class User {
   public static Map<String, String> users = new TreeMap<String, String>();
	 static {
			users = new TreeMap<String,String>();
	}

   @Path("/{u}")
   @PUT
   @Produces("text/html")
   public String create(@PathParam("u") String user, @QueryParam("customer_name") String customerName) {
      users.put(user, customerName);
      return "Added order #" + customerName;
   }

   @Path("/{u}")
   @GET
   @Produces("text/html")
   public String find(@PathParam("u") String name) {
      if (users.containsKey(name))
         return "<h2>Details on User #" + name + "</h2><p>Customer name: " + users.get(name);

      throw new WebApplicationException(Response.Status.NOT_FOUND);
   }

   @Path("/l")
   @GET
   @Produces("text/html")
   public String list() {
      String header = "<h2>All Users</h2>\n";

      header += "<ul>";
      for (Map.Entry<String, String> user : users.entrySet())
         header += "\n<li>#" + user.getKey() + " for " + user.getValue() + "</li>";

      header += "\n</ul>";

      return header;
   }
}
